<app-side-panel>
  <app-page-title [pageTitle]="mode + ' ' + mealType" (onGoBack)="goBack()">
    @if (meal.recipe) {
      <button mat-flat-button (click)="openRecepeDetails(meal.recipe)">
        See recipe
      </button>
    }
  </app-page-title>

  @if (meal) {
  <app-form-base
    [formGroup]="mealForm"
    [formTitle]="meal.name"
    [actionBtns]="actionBtns"
    [error]="errorMessage"
  >
    <div
      class="flex flex-column flex-row-md justify-content-between col-gap-2 mb-4"
    >
      <div id="chart">
        <apx-chart
          [series]="chartOptions.series!"
          [chart]="chartOptions.chart!"
          [labels]="chartOptions.labels!"
          [responsive]="chartOptions.responsive!"
        ></apx-chart>
      </div>

      <div class="align-self-end-md">
        <span class="calories-title font-bold"
          >{{ this.nutrients.calories.toFixed() }}kCal</span
        >
      </div>
    </div>

    <div class="mb-4">
      <mat-accordion class="example-headers-align">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>Nutrients</mat-panel-title>
          </mat-expansion-panel-header>

          <app-nutrients [data]="nutrients" />
        </mat-expansion-panel>
      </mat-accordion>
    </div>

    <div class="flex flex-column flex-row-md col-gap-2 mb-4">
      @if (meal.servings) {
      <app-select-base
        formControlName="served"
        inputLabel="Servings"
        [options]="servingsOptions"
        class="flex full-col"
      />
      } @else {
      <app-input-base
        formControlName="quantity"
        inputLabel="Quantity"
        suffixValue="g"
        type="number"
        class="flex full-col"
      />
      }

      <app-select-base
        formControlName="mealType"
        inputLabel="Meal"
        [options]="mealOptions"
        class="flex full-col"
      />
    </div>
  </app-form-base>
  }
</app-side-panel>
